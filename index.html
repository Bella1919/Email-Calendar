<html lang="test">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
		integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <title>Document</title>
</head>
<body>
    <div style="width:50%;margin:100px 300px">
      <p>
        Dear John, <br/><br/>
        I’m happy to welcome you all to  project. <br/>
        We’ve got a great team set up, and I’m looking forward to seeing what we accomplish together.<br/>
        The meeting details as below:
      </p>
      <p>
        Invitee: John Smith<br/>
        Event:Meeting<br/>
        Start Time: May 24th 2021 7:30pm<br/>
        Finish Time: May 24th 2021 8:00pm<br/>
        location: Europe/Paris<br/>
       
      </p>
      <a href="https://calendar.google.com/calendar/render?action=TEMPLATE&text=Meeting&dates=20210524T193000/20210524T200000&ctz=Europe/Paris&details=example%20meeting">
        <img style="width: 50px; height: 50px; margin: 0px 2px; padding: 0px;" src="https://s287333.sendpul.se/image/files/emailservice/userfiles/8b7773b53d909c8cab2b6c866f914096287333/calendar_icons/google-calendar.png" alt="Google" width="50" height="50" />
          Add to Google calendar
      </a>
      <br>
      <div class="btn" style=" border-radius:5px;padding-left:0px">
        <a id="addGoogleCalendar" href="#" style="width: 250px;height: 35px;color: #fff;text-align: center;display: block;-webkit-border-radius: 3px;-moz-border-radius: 3px;border-radius: 3px;background: #1E88E5;text-decoration: none;line-height: 30p;padding-top: 4px;">
          Add to Google calendar
        </a>
      </div >
      <br>
      <br>
      <a href="https://outlook.live.com/calendar/0/deeplink/compose?&rru=addevent&startdt=2021-05-24T19:30:00+02:00&enddt=2021-05-24T20:00:00+02:00&subject=Meeting&body=example%20meeting">
        <img style="width: 50px; height: 50px; margin: 0px 2px; padding: 0px;" src="https://s287333.sendpul.se/image/files/emailservice/userfiles/8b7773b53d909c8cab2b6c866f914096287333/calendar_icons/outlook-calendar.png" alt="Outlook" width="50" height="50"/>
          Add to Outlook calendar
      </a>
      <br>
      <div class="btn" style=" border-radius:5px;padding-left:0px">
        <a id="addOutlookCalendar" href="#" style="width: 250px;height: 35px;color: #fff;text-align: center;display: block;-webkit-border-radius: 3px;-moz-border-radius: 3px;border-radius: 3px;background: #303F9F;text-decoration: none;line-height: 30p;padding-top: 4px;">
          Add to Outlook calendar
        </a>
      </div >
      <br>
      <br>
      <a href="https://calendar.yahoo.com/?&v=60&ST=20210524T173000000Z&ET=20210524T180000000Z&TITLE=meeting&DESC=test%20meeting">
        <img style="width: 50px; height: 50px; margin: 0px 2px; padding: 0px;" src="https://png.pngtree.com/element_our/md/20180627/md_5b33443c65aa1.jpg" alt="Outlook" width="50" height="50"/>
          Add to Yahoo! calendar
      </a>
      <br>
      <div class="btn" style=" border-radius:5px;padding-left:0px">
        <a id="addYahooCalendar" href="#" style="width: 250px;height: 35px;color: #fff;text-align: center;display: block;-webkit-border-radius: 3px;-moz-border-radius: 3px;border-radius: 3px;background: #9B59B6;text-decoration: none;line-height: 30p;padding-top: 4px;">
          Add to Yahoo! calendar
        </a>
      </div >
      <br>
        <p>
          Can’t wait to get this project off  the ground!<br/>
          Thank you all.<br/><br/>
          Bella
        </p>
    </div> 


    <div>
      <br><br>
      <a id="googleCalendar" href="#">Google Calendar(online)</a>
      <br><br>
      <a id="outlookCalendar" href="#">Outlook Calendar(online)</a>
      <br><br>
      <a id="yahooCalendar" href="#">Yahoo! Calendar(online)</a>
      <br><br>
      <a id="aolCalendar" href="#">AOL Calendar</a>
      <br><br>
      <a id="appleCalendar" href="#">Apple Calendar</a>
    </div>

  
    <script src="/googleCalendar.js"></script>
    <script src="/outlookCalendar.js"></script>
    <script src="/yahooCalendar.js"></script>

    <script>
   

      let title = 'Meeting'
      let description ='Example Meeting'
      let startTime = '2021-05-24T19:30:00+02:00'
      let endTime = '2021-05-24T20:00:00+02:00'


      // function convertToLocalTime (offerTime){
      //   let utcTime = moment(offerTime).utcOffset(0).format();
      //   // console.log(utcTime)
      //   let localTime = moment.utc(utcTime).local().format('lll') 
      //   // console.log(localTime)

      //   return localTime
      // }

      // let localStartTime = this.convertToLocalTime(startTime)
      // console.log(localStartTime)
      // let localEndTime = this.convertToLocalTime(endTime)

     
      function zeroFill($number){
        if($number>=0 && $number<=9){
            $number = "0"+$number
            return $number
        }else{
            return $number
        }
      }

        //convert local start date 
        let startDate = new Date(startTime);
        console.log(startDate)
        let startYear = startDate.getFullYear()
        let startMonth = zeroFill(startDate.getMonth()+1)
        let startDay = zeroFill(startDate.getDate())
        let startHour = zeroFill(startDate.getHours())
        let startMinite = zeroFill(startDate.getMinutes())
        let startSecond = zeroFill(startDate.getSeconds())
          //convert local end date 
        let endDate = new Date(endTime);
        let endYear = endDate.getFullYear()
        let endMonth = zeroFill(endDate.getMonth()+1)
        let endDay = zeroFill(endDate.getDate())
        let endHour = zeroFill(endDate.getHours())
        let endMinite = zeroFill(endDate.getMinutes())
        let endSecond = zeroFill(endDate.getSeconds())

        //format:yyyymmddThhmmss
        let googleFinalStartDate = `${startYear}${startMonth}${startDay}T${startHour}${startMinite}${startSecond}`
        console.log(googleFinalStartDate )
        let googleFinalEndDate = `${endYear}${endMonth}${endDay}T${endHour}${endMinite}${endSecond}`
        console.log(googleFinalEndDate )

        let googleURL = "https://calendar.google.com/calendar/u/0/r/eventedit?"
        this.addToGoogleCalendar()
       
        //menthod to add to google calendar
        function addToGoogleCalendar(){
            let googleApi = `${googleURL}text=${title}&dates=${googleFinalStartDate}/${googleFinalEndDate}&details=${description}`
            let googleObj =  document.getElementById("googleCalendar")
            googleObj.href = googleApi
            console.log(googleObj.href)
        }
        //format:/yyyymmddThhmmss+-00:00
        let outlookFinalStartDate = `${startYear}-${startMonth}-${startDay}T${startHour}:${startMinite}:${startSecond}:00`
        console.log(outlookFinalStartDate)
        let outlookFinalEndDate = `${endYear}-${endMonth}-${endDay}T${endHour}:${endMinite}:${endSecond}:00`
        console.log(outlookFinalEndDate)

        let outlookURL = "https://outlook.live.com/calendar/0/deeplink/compose?"
        this.addToOutlookCalendar()

        //menthod to add to outlook calendar
        function addToOutlookCalendar(){
        let outlookApi = `${outlookURL}&path=/calendar/action/compose&rru=addevent&startdt=${outlookFinalStartDate}&enddt=${outlookFinalEndDate}&subject=${title}&body=${description}`
        let outlookObj =  document.getElementById("outlookCalendar")
        outlookObj.href = outlookApi
        console.log(outlookObj.href)
      }
        //format:yyyymmddThhmmssZ
        let yahooFinalStartDate = `${startYear}${startMonth}${startDay}T${startHour}${startMinite}${startSecond}Z`
        console.log(outlookFinalStartDate )
        let yahooFinalEndDate = `${endYear}${endMonth}${endDay}T${endHour}${endMinite}${endSecond}Z`
        console.log(outlookFinalEndDate )

        let yahooURL = "https://calendar.yahoo.com/?"
        this.addToYahooCalendar()

        //menthod to add to yahoo calendar
        function addToYahooCalendar(){
            let yahooApi = `${yahooURL}&v=60&ST=${yahooFinalStartDate}&ET=${yahooFinalEndDate}&TITLE=${title}&DESC=${description}`
            let yahooObj =  document.getElementById("yahooCalendar")
            yahooObj.href = yahooApi
            console.log(yahooObj.href)
        }

    </script>
</body>
</html>